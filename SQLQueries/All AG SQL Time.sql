
CREATE TABLE CzechDAYS AS
SELECT 
    ROWID AS RID,
    CASE WHEN "Pohlavikod" = 'F' THEN 1 ELSE 0 END AS GENDER, 
    strftime('%Y', '2023-01-01') - "Rok_narozeni" AS AGE_2023,
    CAST((julianday("DatumUmrti", 'start of day') - julianday('2020-01-01','start of day')) AS INTEGER) AS D,
    CAST((julianday("Datum_1", 'start of day') - julianday('2020-01-01','start of day')) AS INTEGER) AS VD1, 
    CAST((julianday("Datum_2", 'start of day') - julianday('2020-01-01','start of day')) AS INTEGER) AS VD2, 
    CAST((julianday("Datum_3", 'start of day') - julianday('2020-01-01','start of day')) AS INTEGER) AS VD3, 
    CAST((julianday("Datum_4", 'start of day') - julianday('2020-01-01','start of day')) AS INTEGER) AS VD4, 
    CAST((julianday("Datum_5", 'start of day') - julianday('2020-01-01','start of day')) AS INTEGER) AS VD5, 
    CAST((julianday("Datum_6", 'start of day') - julianday('2020-01-01','start of day')) AS INTEGER) AS VD6, 
    CAST((julianday("Datum_7", 'start of day') - julianday('2020-01-01','start of day')) AS INTEGER) AS VD7
FROM czech;

CREATE INDEX idx_CzechDAYS_RID ON CzechDAYS(RID);

COMMIT;

--Create the table DAYS_RANGE
DROP TABLE IF EXISTS DAYS_RANGE;
CREATE TABLE DAYS_RANGE (
    DAY INTEGER
);
-- Insert the days using a recursive CTE
WITH RECURSIVE date_range AS (
    SELECT 0 AS day
    UNION ALL
    SELECT day + 1
    FROM date_range
    WHERE day < (julianday('2024-03-13') - julianday('2020-01-01'))
)
INSERT INTO DAYS_RANGE (DAY)SELECT day FROM date_range;

--Create the table AGE_RANGE
DROP TABLE IF EXISTS AGE_RANGE;
CREATE TABLE AGE_RANGE (
    AGE_2023 INTEGER
);
INSERT INTO AGE_RANGE select distinct AGE_2023 FROM CzechDAYS order by AGE_2023;

-- Create the table DAYS_AGE_RANGE 
DROP TABLE IF EXISTS DAYS_AGE_RANGE;
CREATE TABLE DAYS_AGE_RANGE (
  DAY INT,
  AGE_2023 INT,
  NUM_D INT,
  NUM_DUVX INT,  
  NUM_DVX INT,
  NUM_DVD1 INT,
  NUM_DVD2 INT,
  NUM_DVD3 INT,
  NUM_DVD4 INT,
  NUM_DVD5 INT,
  NUM_DVD6 INT,
  NUM_DVD7 INT,
  NUM_DVDA INT,
  NUM_POP INT,
  NUM_UVX INT,
  NUM_VX INT,
  NUM_VD1 INT,
  NUM_VD2 INT,
  NUM_VD3 INT,
  NUM_VD4 INT,
  NUM_VD5 INT,
  NUM_VD6 INT,
  NUM_VD7 INT,
  NUM_VDA INT   
);

-- Populate empty table DAYS_AGE_RANGE with data day ranges 1-1533 and age ranges
INSERT INTO DAYS_AGE_RANGE (DAY, AGE_2023)
SELECT d.DAY, c.AGE_2023
FROM DAYS_RANGE d
CROSS JOIN (SELECT DISTINCT AGE_2023 FROM AGE_RANGE ORDER BY AGE_2023) c
ORDER BY d.DAY, c.AGE_2023;


-- BEGIN insert values from CzechDAYS into table DAYS_AGE_RANGE for Day 0-1533 range and age range 

-- Calculate total population for each age update NUM_POP
CREATE TEMPORARY TABLE TotalPopulation AS
SELECT AGE_2023, COUNT(*) AS NUM_POP
FROM CzechDAYS
GROUP BY AGE_2023;

CREATE TEMPORARY TABLE TempUpdated AS
SELECT 
    dar.DAY,
    dar.AGE_2023,
    tp.NUM_POP
FROM 
    DAYS_AGE_RANGE dar
JOIN
    TotalPopulation tp ON dar.AGE_2023 = tp.AGE_2023;

UPDATE DAYS_AGE_RANGE
SET 
    NUM_POP = tu.NUM_POP
FROM 
    TempUpdated tu
WHERE 
    DAYS_AGE_RANGE.DAY = tu.DAY AND DAYS_AGE_RANGE.AGE_2023 = tu.AGE_2023;

DROP TABLE TempUpdated;
DROP TABLE TotalPopulation;

-- update table DAYS_AGE_RANGE NUM_VX
DROP INDEX IF EXISTS idx_CzechDAYS_vd1_age;	
CREATE INDEX idx_CzechDAYS_vd1_age ON CzechDAYS (VD1, AGE_2023);
UPDATE DAYS_AGE_RANGE
SET 
    NUM_VX = (
        SELECT COUNT(*)
        FROM CzechDAYS t
        WHERE t.VD1 = DAYS_AGE_RANGE.DAY
        AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
    );

UPDATE DAYS_AGE_RANGE
SET NUM_UVX = NUM_VX * -1;

DROP INDEX IF EXISTS idx_CzechDAYS_vd1_age;	
CREATE INDEX idx_CzechDAYS_vd1_age ON CzechDAYS (VD1, AGE_2023);
UPDATE DAYS_AGE_RANGE
SET 
    NUM_VD1 = (
        SELECT COUNT(*)
        FROM CzechDAYS t
        WHERE t.VD1 = DAYS_AGE_RANGE.DAY
        AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
    );
	
DROP INDEX IF EXISTS idx_CzechDAYS_vd2_age;	
CREATE INDEX idx_CzechDAYS_vd2_age ON CzechDAYS (VD2, AGE_2023);
UPDATE DAYS_AGE_RANGE
SET 
    NUM_VD2 = (
        SELECT COUNT(*)
        FROM CzechDAYS t
        WHERE t.VD2 = DAYS_AGE_RANGE.DAY
        AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
    );
	
DROP INDEX IF EXISTS idx_CzechDAYS_vd3_age;	
CREATE INDEX idx_CzechDAYS_vd3_age ON CzechDAYS (VD3, AGE_2023);
UPDATE DAYS_AGE_RANGE
SET 
    NUM_VD3 = (
        SELECT COUNT(*)
        FROM CzechDAYS t
        WHERE t.VD3 = DAYS_AGE_RANGE.DAY
        AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
    );

DROP INDEX IF EXISTS idx_CzechDAYS_vd4_age;	
CREATE INDEX idx_CzechDAYS_vd4_age ON CzechDAYS (VD4, AGE_2023);
UPDATE DAYS_AGE_RANGE
SET 
    NUM_VD4 = (
        SELECT COUNT(*)
        FROM CzechDAYS t
        WHERE t.VD4 = DAYS_AGE_RANGE.DAY
        AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
    );
	
DROP INDEX IF EXISTS idx_CzechDAYS_vd5_age;	
CREATE INDEX idx_CzechDAYS_vd5_age ON CzechDAYS (VD5, AGE_2023);
UPDATE DAYS_AGE_RANGE
SET 
    NUM_VD5 = (
        SELECT COUNT(*)
        FROM CzechDAYS t
        WHERE t.VD5 = DAYS_AGE_RANGE.DAY
        AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
    );

DROP INDEX IF EXISTS idx_CzechDAYS_vd6_age;	
CREATE INDEX idx_CzechDAYS_vd6_age ON CzechDAYS (VD6, AGE_2023);
UPDATE DAYS_AGE_RANGE
SET 
    NUM_VD6 = (
        SELECT COUNT(*)
        FROM CzechDAYS t
        WHERE t.VD6 = DAYS_AGE_RANGE.DAY
        AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
    );

DROP INDEX IF EXISTS idx_CzechDAYS_vd7_age;	
CREATE INDEX idx_CzechDAYS_vd7_age ON CzechDAYS (VD7, AGE_2023);
UPDATE DAYS_AGE_RANGE
SET 
    NUM_VD7 = (
        SELECT COUNT(*)
        FROM CzechDAYS t
        WHERE t.VD7 = DAYS_AGE_RANGE.DAY
        AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
    );

	
DROP INDEX IF EXISTS idx_CzechDAYS_d_age;	
CREATE INDEX idx_CzechDAYS_d_age ON CzechDAYS (D, AGE_2023);
UPDATE DAYS_AGE_RANGE
SET 
    NUM_D = (
        SELECT COUNT(*)
        FROM CzechDAYS t
        WHERE t.D = DAYS_AGE_RANGE.DAY
        AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
    );

UPDATE DAYS_AGE_RANGE
SET 
    NUM_DUVX = (
        SELECT COUNT(*)
        FROM CzechDAYS t
        WHERE t.D = DAYS_AGE_RANGE.DAY
        AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
		AND t.VD1 IS NULL
		AND t.VD2 IS NULL
		AND t.VD3 IS NULL
		AND t.VD4 IS NULL
		AND t.VD5 IS NULL
		AND t.VD6 IS NULL
		AND t.VD7 IS NULL
    );

UPDATE DAYS_AGE_RANGE
SET 
    NUM_DVX = (
        SELECT COUNT(*)
        FROM CzechDAYS t
        WHERE t.D = DAYS_AGE_RANGE.DAY
        AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
		AND (t.VD1 IS NOT NULL
		OR t.VD2 IS NOT NULL
		OR t.VD3 IS NOT NULL
		OR t.VD4 IS NOT NULL
		OR  t.VD5 IS NOT NULL
		OR  t.VD6 IS NOT NULL
		OR t.VD7 IS NOT NULL)
    );
	
UPDATE DAYS_AGE_RANGE
SET NUM_DVD1 = (
    SELECT COUNT(*)
    FROM CzechDAYS t
    WHERE t.D = DAYS_AGE_RANGE.DAY
      AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
      AND t.D IS NOT NULL
	  AND t.VD1 IS NOT NULL      
      AND t.VD2 IS NULL
      AND t.VD3 IS NULL
      AND t.VD4 IS NULL
      AND t.VD5 IS NULL
      AND t.VD6 IS NULL
      AND t.VD7 IS NULL
);

UPDATE DAYS_AGE_RANGE
SET NUM_DVD2 = (
    SELECT COUNT(*)
    FROM CzechDAYS t
    WHERE t.D = DAYS_AGE_RANGE.DAY
      AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
      AND t.D IS NOT NULL
	  AND t.VD2 IS NOT NULL
      AND t.VD3 IS NULL
      AND t.VD4 IS NULL
      AND t.VD5 IS NULL
      AND t.VD6 IS NULL
      AND t.VD7 IS NULL
);

UPDATE DAYS_AGE_RANGE
SET NUM_DVD3 = (
    SELECT COUNT(*)
    FROM CzechDAYS t
    WHERE t.D = DAYS_AGE_RANGE.DAY
      AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
      AND t.D IS NOT NULL
	  AND t.VD3 IS NOT NULL
      AND t.VD4 IS NULL
      AND t.VD5 IS NULL
      AND t.VD6 IS NULL
      AND t.VD7 IS NULL
);

UPDATE DAYS_AGE_RANGE
SET NUM_DVD4 = (
    SELECT COUNT(*)
    FROM CzechDAYS t
    WHERE t.D = DAYS_AGE_RANGE.DAY
      AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
      AND t.D IS NOT NULL
	  AND t.VD4 IS NOT NULL
      AND t.VD5 IS NULL
      AND t.VD6 IS NULL
      AND t.VD7 IS NULL
);

UPDATE DAYS_AGE_RANGE
SET NUM_DVD5 = (
    SELECT COUNT(*)
    FROM CzechDAYS t
    WHERE t.D = DAYS_AGE_RANGE.DAY
      AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
      AND t.D IS NOT NULL
	  AND t.VD5 IS NOT NULL
      AND t.VD6 IS NULL
      AND t.VD7 IS NULL
);

UPDATE DAYS_AGE_RANGE
SET NUM_DVD6 = (
    SELECT COUNT(*)
    FROM CzechDAYS t
    WHERE t.D = DAYS_AGE_RANGE.DAY
      AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
      AND t.D IS NOT NULL
	  AND t.VD6 IS NOT NULL
      AND t.VD7 IS NULL
);

UPDATE DAYS_AGE_RANGE
SET NUM_DVD7 = (
    SELECT COUNT(*)
    FROM CzechDAYS t
    WHERE t.D = DAYS_AGE_RANGE.DAY
      AND t.AGE_2023 = DAYS_AGE_RANGE.AGE_2023
      AND t.D IS NOT NULL
	  AND t.VD7 IS NOT NULL
);


-- Update the column NUM_DVDA and NUM_VDA - for all doses - as sum of dose 1-7 values 
UPDATE days_age_range
SET NUM_DVDA = NUM_DVD1 + NUM_DVD2 + NUM_DVD3 + NUM_DVD4 + NUM_DVD5 + NUM_DVD6 + NUM_DVD7,
    NUM_VDA = NUM_VD1 + NUM_VD2 + NUM_VD3 + NUM_VD4 + NUM_VD5 + NUM_VD6 + + NUM_VD7;


-- END insert values from CzechDAYS into table DAYS_AGE_RANGE for Day 0 to 1533

	
	
-- create view PVT_NUM_POP
DROP VIEW IF EXISTS PVT_NUM_POP;
CREATE VIEW PVT_NUM_POP AS
SELECT 
    DAY,
    SUM(CASE WHEN AGE_2023 = 0 THEN NUM_POP ELSE 0 END) AS '0',
    SUM(CASE WHEN AGE_2023 = 1 THEN NUM_POP ELSE 0 END) AS '1',
    SUM(CASE WHEN AGE_2023 = 2 THEN NUM_POP ELSE 0 END) AS '2',
    SUM(CASE WHEN AGE_2023 = 3 THEN NUM_POP ELSE 0 END) AS '3',
    SUM(CASE WHEN AGE_2023 = 4 THEN NUM_POP ELSE 0 END) AS '4',
    SUM(CASE WHEN AGE_2023 = 5 THEN NUM_POP ELSE 0 END) AS '5',
    SUM(CASE WHEN AGE_2023 = 6 THEN NUM_POP ELSE 0 END) AS '6',
    SUM(CASE WHEN AGE_2023 = 7 THEN NUM_POP ELSE 0 END) AS '7',
    SUM(CASE WHEN AGE_2023 = 8 THEN NUM_POP ELSE 0 END) AS '8',
    SUM(CASE WHEN AGE_2023 = 9 THEN NUM_POP ELSE 0 END) AS '9',
    SUM(CASE WHEN AGE_2023 = 10 THEN NUM_POP ELSE 0 END) AS '10',
    SUM(CASE WHEN AGE_2023 = 11 THEN NUM_POP ELSE 0 END) AS '11',
    SUM(CASE WHEN AGE_2023 = 12 THEN NUM_POP ELSE 0 END) AS '12',
    SUM(CASE WHEN AGE_2023 = 13 THEN NUM_POP ELSE 0 END) AS '13',
    SUM(CASE WHEN AGE_2023 = 14 THEN NUM_POP ELSE 0 END) AS '14',
    SUM(CASE WHEN AGE_2023 = 15 THEN NUM_POP ELSE 0 END) AS '15',
    SUM(CASE WHEN AGE_2023 = 16 THEN NUM_POP ELSE 0 END) AS '16',
    SUM(CASE WHEN AGE_2023 = 17 THEN NUM_POP ELSE 0 END) AS '17',
    SUM(CASE WHEN AGE_2023 = 18 THEN NUM_POP ELSE 0 END) AS '18',
    SUM(CASE WHEN AGE_2023 = 19 THEN NUM_POP ELSE 0 END) AS '19',
    SUM(CASE WHEN AGE_2023 = 20 THEN NUM_POP ELSE 0 END) AS '20',
    SUM(CASE WHEN AGE_2023 = 21 THEN NUM_POP ELSE 0 END) AS '21',
    SUM(CASE WHEN AGE_2023 = 22 THEN NUM_POP ELSE 0 END) AS '22',
    SUM(CASE WHEN AGE_2023 = 23 THEN NUM_POP ELSE 0 END) AS '23',
    SUM(CASE WHEN AGE_2023 = 24 THEN NUM_POP ELSE 0 END) AS '24',
    SUM(CASE WHEN AGE_2023 = 25 THEN NUM_POP ELSE 0 END) AS '25',
    SUM(CASE WHEN AGE_2023 = 26 THEN NUM_POP ELSE 0 END) AS '26',
    SUM(CASE WHEN AGE_2023 = 27 THEN NUM_POP ELSE 0 END) AS '27',
    SUM(CASE WHEN AGE_2023 = 28 THEN NUM_POP ELSE 0 END) AS '28',
    SUM(CASE WHEN AGE_2023 = 29 THEN NUM_POP ELSE 0 END) AS '29',
    SUM(CASE WHEN AGE_2023 = 30 THEN NUM_POP ELSE 0 END) AS '30',
    SUM(CASE WHEN AGE_2023 = 31 THEN NUM_POP ELSE 0 END) AS '31',
    SUM(CASE WHEN AGE_2023 = 32 THEN NUM_POP ELSE 0 END) AS '32',
    SUM(CASE WHEN AGE_2023 = 33 THEN NUM_POP ELSE 0 END) AS '33',
    SUM(CASE WHEN AGE_2023 = 34 THEN NUM_POP ELSE 0 END) AS '34',
    SUM(CASE WHEN AGE_2023 = 35 THEN NUM_POP ELSE 0 END) AS '35',
    SUM(CASE WHEN AGE_2023 = 36 THEN NUM_POP ELSE 0 END) AS '36',
    SUM(CASE WHEN AGE_2023 = 37 THEN NUM_POP ELSE 0 END) AS '37',
    SUM(CASE WHEN AGE_2023 = 38 THEN NUM_POP ELSE 0 END) AS '38',
    SUM(CASE WHEN AGE_2023 = 39 THEN NUM_POP ELSE 0 END) AS '39',
    SUM(CASE WHEN AGE_2023 = 40 THEN NUM_POP ELSE 0 END) AS '40',
    SUM(CASE WHEN AGE_2023 = 41 THEN NUM_POP ELSE 0 END) AS '41',
    SUM(CASE WHEN AGE_2023 = 42 THEN NUM_POP ELSE 0 END) AS '42',
    SUM(CASE WHEN AGE_2023 = 43 THEN NUM_POP ELSE 0 END) AS '43',
    SUM(CASE WHEN AGE_2023 = 44 THEN NUM_POP ELSE 0 END) AS '44',
    SUM(CASE WHEN AGE_2023 = 45 THEN NUM_POP ELSE 0 END) AS '45',
    SUM(CASE WHEN AGE_2023 = 46 THEN NUM_POP ELSE 0 END) AS '46',
    SUM(CASE WHEN AGE_2023 = 47 THEN NUM_POP ELSE 0 END) AS '47',
    SUM(CASE WHEN AGE_2023 = 48 THEN NUM_POP ELSE 0 END) AS '48',
    SUM(CASE WHEN AGE_2023 = 49 THEN NUM_POP ELSE 0 END) AS '49',
    SUM(CASE WHEN AGE_2023 = 50 THEN NUM_POP ELSE 0 END) AS '50',
    SUM(CASE WHEN AGE_2023 = 51 THEN NUM_POP ELSE 0 END) AS '51',
    SUM(CASE WHEN AGE_2023 = 52 THEN NUM_POP ELSE 0 END) AS '52',
    SUM(CASE WHEN AGE_2023 = 53 THEN NUM_POP ELSE 0 END) AS '53',
    SUM(CASE WHEN AGE_2023 = 54 THEN NUM_POP ELSE 0 END) AS '54',
    SUM(CASE WHEN AGE_2023 = 55 THEN NUM_POP ELSE 0 END) AS '55',
    SUM(CASE WHEN AGE_2023 = 56 THEN NUM_POP ELSE 0 END) AS '56',
    SUM(CASE WHEN AGE_2023 = 57 THEN NUM_POP ELSE 0 END) AS '57',
    SUM(CASE WHEN AGE_2023 = 58 THEN NUM_POP ELSE 0 END) AS '58',
    SUM(CASE WHEN AGE_2023 = 59 THEN NUM_POP ELSE 0 END) AS '59',
    SUM(CASE WHEN AGE_2023 = 60 THEN NUM_POP ELSE 0 END) AS '60',
    SUM(CASE WHEN AGE_2023 = 61 THEN NUM_POP ELSE 0 END) AS '61',
    SUM(CASE WHEN AGE_2023 = 62 THEN NUM_POP ELSE 0 END) AS '62',
    SUM(CASE WHEN AGE_2023 = 63 THEN NUM_POP ELSE 0 END) AS '63',
    SUM(CASE WHEN AGE_2023 = 64 THEN NUM_POP ELSE 0 END) AS '64',
    SUM(CASE WHEN AGE_2023 = 65 THEN NUM_POP ELSE 0 END) AS '65',
    SUM(CASE WHEN AGE_2023 = 66 THEN NUM_POP ELSE 0 END) AS '66',
    SUM(CASE WHEN AGE_2023 = 67 THEN NUM_POP ELSE 0 END) AS '67',
    SUM(CASE WHEN AGE_2023 = 68 THEN NUM_POP ELSE 0 END) AS '68',
    SUM(CASE WHEN AGE_2023 = 69 THEN NUM_POP ELSE 0 END) AS '69',
    SUM(CASE WHEN AGE_2023 = 70 THEN NUM_POP ELSE 0 END) AS '70',
    SUM(CASE WHEN AGE_2023 = 71 THEN NUM_POP ELSE 0 END) AS '71',
    SUM(CASE WHEN AGE_2023 = 72 THEN NUM_POP ELSE 0 END) AS '72',
    SUM(CASE WHEN AGE_2023 = 73 THEN NUM_POP ELSE 0 END) AS '73',
    SUM(CASE WHEN AGE_2023 = 74 THEN NUM_POP ELSE 0 END) AS '74',
    SUM(CASE WHEN AGE_2023 = 75 THEN NUM_POP ELSE 0 END) AS '75',
    SUM(CASE WHEN AGE_2023 = 76 THEN NUM_POP ELSE 0 END) AS '76',
    SUM(CASE WHEN AGE_2023 = 77 THEN NUM_POP ELSE 0 END) AS '77',
    SUM(CASE WHEN AGE_2023 = 78 THEN NUM_POP ELSE 0 END) AS '78',
    SUM(CASE WHEN AGE_2023 = 79 THEN NUM_POP ELSE 0 END) AS '79',
    SUM(CASE WHEN AGE_2023 = 80 THEN NUM_POP ELSE 0 END) AS '80',
    SUM(CASE WHEN AGE_2023 = 81 THEN NUM_POP ELSE 0 END) AS '81',
    SUM(CASE WHEN AGE_2023 = 82 THEN NUM_POP ELSE 0 END) AS '82',
    SUM(CASE WHEN AGE_2023 = 83 THEN NUM_POP ELSE 0 END) AS '83',
    SUM(CASE WHEN AGE_2023 = 84 THEN NUM_POP ELSE 0 END) AS '84',
    SUM(CASE WHEN AGE_2023 = 85 THEN NUM_POP ELSE 0 END) AS '85',
    SUM(CASE WHEN AGE_2023 = 86 THEN NUM_POP ELSE 0 END) AS '86',
    SUM(CASE WHEN AGE_2023 = 87 THEN NUM_POP ELSE 0 END) AS '87',
    SUM(CASE WHEN AGE_2023 = 88 THEN NUM_POP ELSE 0 END) AS '88',
    SUM(CASE WHEN AGE_2023 = 89 THEN NUM_POP ELSE 0 END) AS '89',
    SUM(CASE WHEN AGE_2023 = 90 THEN NUM_POP ELSE 0 END) AS '90',
    SUM(CASE WHEN AGE_2023 = 91 THEN NUM_POP ELSE 0 END) AS '91',
    SUM(CASE WHEN AGE_2023 = 92 THEN NUM_POP ELSE 0 END) AS '92',
    SUM(CASE WHEN AGE_2023 = 93 THEN NUM_POP ELSE 0 END) AS '93',
    SUM(CASE WHEN AGE_2023 = 94 THEN NUM_POP ELSE 0 END) AS '94',
    SUM(CASE WHEN AGE_2023 = 95 THEN NUM_POP ELSE 0 END) AS '95',
    SUM(CASE WHEN AGE_2023 = 96 THEN NUM_POP ELSE 0 END) AS '96',
    SUM(CASE WHEN AGE_2023 = 97 THEN NUM_POP ELSE 0 END) AS '97',
    SUM(CASE WHEN AGE_2023 = 98 THEN NUM_POP ELSE 0 END) AS '98',
    SUM(CASE WHEN AGE_2023 = 99 THEN NUM_POP ELSE 0 END) AS '99',
    SUM(CASE WHEN AGE_2023 = 100 THEN NUM_POP ELSE 0 END) AS '100',
    SUM(CASE WHEN AGE_2023 = 101 THEN NUM_POP ELSE 0 END) AS '101',
    SUM(CASE WHEN AGE_2023 = 102 THEN NUM_POP ELSE 0 END) AS '102',
    SUM(CASE WHEN AGE_2023 = 103 THEN NUM_POP ELSE 0 END) AS '103',
    SUM(CASE WHEN AGE_2023 = 104 THEN NUM_POP ELSE 0 END) AS '104',
    SUM(CASE WHEN AGE_2023 = 105 THEN NUM_POP ELSE 0 END) AS '105',
    SUM(CASE WHEN AGE_2023 = 106 THEN NUM_POP ELSE 0 END) AS '106',
    SUM(CASE WHEN AGE_2023 = 107 THEN NUM_POP ELSE 0 END) AS '107',
    SUM(CASE WHEN AGE_2023 = 108 THEN NUM_POP ELSE 0 END) AS '108',
    SUM(CASE WHEN AGE_2023 = 109 THEN NUM_POP ELSE 0 END) AS '109',
    SUM(CASE WHEN AGE_2023 = 110 THEN NUM_POP ELSE 0 END) AS '110',
    SUM(CASE WHEN AGE_2023 = 111 THEN NUM_POP ELSE 0 END) AS '111',
    SUM(CASE WHEN AGE_2023 = 112 THEN NUM_POP ELSE 0 END) AS '112',
    SUM(CASE WHEN AGE_2023 = 113 THEN NUM_POP ELSE 0 END) AS '113'
FROM (
    SELECT DISTINCT 
        DAY, 
        AGE_2023, 
        DAYS_AGE_RANGE.NUM_POP
    FROM 
        DAYS_AGE_RANGE
) AS NUM_POP
GROUP BY DAY;

-- create view PVT_NUM_D
DROP VIEW IF EXISTS PVT_NUM_D;
CREATE VIEW PVT_NUM_D AS
SELECT 
    DAY,
    SUM(CASE WHEN AGE_2023 = 0 THEN NUM_D ELSE 0 END) AS '0',
    SUM(CASE WHEN AGE_2023 = 1 THEN NUM_D ELSE 0 END) AS '1',
    SUM(CASE WHEN AGE_2023 = 2 THEN NUM_D ELSE 0 END) AS '2',
    SUM(CASE WHEN AGE_2023 = 3 THEN NUM_D ELSE 0 END) AS '3',
    SUM(CASE WHEN AGE_2023 = 4 THEN NUM_D ELSE 0 END) AS '4',
    SUM(CASE WHEN AGE_2023 = 5 THEN NUM_D ELSE 0 END) AS '5',
    SUM(CASE WHEN AGE_2023 = 6 THEN NUM_D ELSE 0 END) AS '6',
    SUM(CASE WHEN AGE_2023 = 7 THEN NUM_D ELSE 0 END) AS '7',
    SUM(CASE WHEN AGE_2023 = 8 THEN NUM_D ELSE 0 END) AS '8',
    SUM(CASE WHEN AGE_2023 = 9 THEN NUM_D ELSE 0 END) AS '9',
    SUM(CASE WHEN AGE_2023 = 10 THEN NUM_D ELSE 0 END) AS '10',
    SUM(CASE WHEN AGE_2023 = 11 THEN NUM_D ELSE 0 END) AS '11',
    SUM(CASE WHEN AGE_2023 = 12 THEN NUM_D ELSE 0 END) AS '12',
    SUM(CASE WHEN AGE_2023 = 13 THEN NUM_D ELSE 0 END) AS '13',
    SUM(CASE WHEN AGE_2023 = 14 THEN NUM_D ELSE 0 END) AS '14',
    SUM(CASE WHEN AGE_2023 = 15 THEN NUM_D ELSE 0 END) AS '15',
    SUM(CASE WHEN AGE_2023 = 16 THEN NUM_D ELSE 0 END) AS '16',
    SUM(CASE WHEN AGE_2023 = 17 THEN NUM_D ELSE 0 END) AS '17',
    SUM(CASE WHEN AGE_2023 = 18 THEN NUM_D ELSE 0 END) AS '18',
    SUM(CASE WHEN AGE_2023 = 19 THEN NUM_D ELSE 0 END) AS '19',
    SUM(CASE WHEN AGE_2023 = 20 THEN NUM_D ELSE 0 END) AS '20',
    SUM(CASE WHEN AGE_2023 = 21 THEN NUM_D ELSE 0 END) AS '21',
    SUM(CASE WHEN AGE_2023 = 22 THEN NUM_D ELSE 0 END) AS '22',
    SUM(CASE WHEN AGE_2023 = 23 THEN NUM_D ELSE 0 END) AS '23',
    SUM(CASE WHEN AGE_2023 = 24 THEN NUM_D ELSE 0 END) AS '24',
    SUM(CASE WHEN AGE_2023 = 25 THEN NUM_D ELSE 0 END) AS '25',
    SUM(CASE WHEN AGE_2023 = 26 THEN NUM_D ELSE 0 END) AS '26',
    SUM(CASE WHEN AGE_2023 = 27 THEN NUM_D ELSE 0 END) AS '27',
    SUM(CASE WHEN AGE_2023 = 28 THEN NUM_D ELSE 0 END) AS '28',
    SUM(CASE WHEN AGE_2023 = 29 THEN NUM_D ELSE 0 END) AS '29',
    SUM(CASE WHEN AGE_2023 = 30 THEN NUM_D ELSE 0 END) AS '30',
    SUM(CASE WHEN AGE_2023 = 31 THEN NUM_D ELSE 0 END) AS '31',
    SUM(CASE WHEN AGE_2023 = 32 THEN NUM_D ELSE 0 END) AS '32',
    SUM(CASE WHEN AGE_2023 = 33 THEN NUM_D ELSE 0 END) AS '33',
    SUM(CASE WHEN AGE_2023 = 34 THEN NUM_D ELSE 0 END) AS '34',
    SUM(CASE WHEN AGE_2023 = 35 THEN NUM_D ELSE 0 END) AS '35',
    SUM(CASE WHEN AGE_2023 = 36 THEN NUM_D ELSE 0 END) AS '36',
    SUM(CASE WHEN AGE_2023 = 37 THEN NUM_D ELSE 0 END) AS '37',
    SUM(CASE WHEN AGE_2023 = 38 THEN NUM_D ELSE 0 END) AS '38',
    SUM(CASE WHEN AGE_2023 = 39 THEN NUM_D ELSE 0 END) AS '39',
    SUM(CASE WHEN AGE_2023 = 40 THEN NUM_D ELSE 0 END) AS '40',
    SUM(CASE WHEN AGE_2023 = 41 THEN NUM_D ELSE 0 END) AS '41',
    SUM(CASE WHEN AGE_2023 = 42 THEN NUM_D ELSE 0 END) AS '42',
    SUM(CASE WHEN AGE_2023 = 43 THEN NUM_D ELSE 0 END) AS '43',
    SUM(CASE WHEN AGE_2023 = 44 THEN NUM_D ELSE 0 END) AS '44',
    SUM(CASE WHEN AGE_2023 = 45 THEN NUM_D ELSE 0 END) AS '45',
    SUM(CASE WHEN AGE_2023 = 46 THEN NUM_D ELSE 0 END) AS '46',
    SUM(CASE WHEN AGE_2023 = 47 THEN NUM_D ELSE 0 END) AS '47',
    SUM(CASE WHEN AGE_2023 = 48 THEN NUM_D ELSE 0 END) AS '48',
    SUM(CASE WHEN AGE_2023 = 49 THEN NUM_D ELSE 0 END) AS '49',
    SUM(CASE WHEN AGE_2023 = 50 THEN NUM_D ELSE 0 END) AS '50',
    SUM(CASE WHEN AGE_2023 = 51 THEN NUM_D ELSE 0 END) AS '51',
    SUM(CASE WHEN AGE_2023 = 52 THEN NUM_D ELSE 0 END) AS '52',
    SUM(CASE WHEN AGE_2023 = 53 THEN NUM_D ELSE 0 END) AS '53',
    SUM(CASE WHEN AGE_2023 = 54 THEN NUM_D ELSE 0 END) AS '54',
    SUM(CASE WHEN AGE_2023 = 55 THEN NUM_D ELSE 0 END) AS '55',
    SUM(CASE WHEN AGE_2023 = 56 THEN NUM_D ELSE 0 END) AS '56',
    SUM(CASE WHEN AGE_2023 = 57 THEN NUM_D ELSE 0 END) AS '57',
    SUM(CASE WHEN AGE_2023 = 58 THEN NUM_D ELSE 0 END) AS '58',
    SUM(CASE WHEN AGE_2023 = 59 THEN NUM_D ELSE 0 END) AS '59',
    SUM(CASE WHEN AGE_2023 = 60 THEN NUM_D ELSE 0 END) AS '60',
    SUM(CASE WHEN AGE_2023 = 61 THEN NUM_D ELSE 0 END) AS '61',
    SUM(CASE WHEN AGE_2023 = 62 THEN NUM_D ELSE 0 END) AS '62',
    SUM(CASE WHEN AGE_2023 = 63 THEN NUM_D ELSE 0 END) AS '63',
    SUM(CASE WHEN AGE_2023 = 64 THEN NUM_D ELSE 0 END) AS '64',
    SUM(CASE WHEN AGE_2023 = 65 THEN NUM_D ELSE 0 END) AS '65',
    SUM(CASE WHEN AGE_2023 = 66 THEN NUM_D ELSE 0 END) AS '66',
    SUM(CASE WHEN AGE_2023 = 67 THEN NUM_D ELSE 0 END) AS '67',
    SUM(CASE WHEN AGE_2023 = 68 THEN NUM_D ELSE 0 END) AS '68',
    SUM(CASE WHEN AGE_2023 = 69 THEN NUM_D ELSE 0 END) AS '69',
    SUM(CASE WHEN AGE_2023 = 70 THEN NUM_D ELSE 0 END) AS '70',
    SUM(CASE WHEN AGE_2023 = 71 THEN NUM_D ELSE 0 END) AS '71',
    SUM(CASE WHEN AGE_2023 = 72 THEN NUM_D ELSE 0 END) AS '72',
    SUM(CASE WHEN AGE_2023 = 73 THEN NUM_D ELSE 0 END) AS '73',
    SUM(CASE WHEN AGE_2023 = 74 THEN NUM_D ELSE 0 END) AS '74',
    SUM(CASE WHEN AGE_2023 = 75 THEN NUM_D ELSE 0 END) AS '75',
    SUM(CASE WHEN AGE_2023 = 76 THEN NUM_D ELSE 0 END) AS '76',
    SUM(CASE WHEN AGE_2023 = 77 THEN NUM_D ELSE 0 END) AS '77',
    SUM(CASE WHEN AGE_2023 = 78 THEN NUM_D ELSE 0 END) AS '78',
    SUM(CASE WHEN AGE_2023 = 79 THEN NUM_D ELSE 0 END) AS '79',
    SUM(CASE WHEN AGE_2023 = 80 THEN NUM_D ELSE 0 END) AS '80',
    SUM(CASE WHEN AGE_2023 = 81 THEN NUM_D ELSE 0 END) AS '81',
    SUM(CASE WHEN AGE_2023 = 82 THEN NUM_D ELSE 0 END) AS '82',
    SUM(CASE WHEN AGE_2023 = 83 THEN NUM_D ELSE 0 END) AS '83',
    SUM(CASE WHEN AGE_2023 = 84 THEN NUM_D ELSE 0 END) AS '84',
    SUM(CASE WHEN AGE_2023 = 85 THEN NUM_D ELSE 0 END) AS '85',
    SUM(CASE WHEN AGE_2023 = 86 THEN NUM_D ELSE 0 END) AS '86',
    SUM(CASE WHEN AGE_2023 = 87 THEN NUM_D ELSE 0 END) AS '87',
    SUM(CASE WHEN AGE_2023 = 88 THEN NUM_D ELSE 0 END) AS '88',
    SUM(CASE WHEN AGE_2023 = 89 THEN NUM_D ELSE 0 END) AS '89',
    SUM(CASE WHEN AGE_2023 = 90 THEN NUM_D ELSE 0 END) AS '90',
    SUM(CASE WHEN AGE_2023 = 91 THEN NUM_D ELSE 0 END) AS '91',
    SUM(CASE WHEN AGE_2023 = 92 THEN NUM_D ELSE 0 END) AS '92',
    SUM(CASE WHEN AGE_2023 = 93 THEN NUM_D ELSE 0 END) AS '93',
    SUM(CASE WHEN AGE_2023 = 94 THEN NUM_D ELSE 0 END) AS '94',
    SUM(CASE WHEN AGE_2023 = 95 THEN NUM_D ELSE 0 END) AS '95',
    SUM(CASE WHEN AGE_2023 = 96 THEN NUM_D ELSE 0 END) AS '96',
    SUM(CASE WHEN AGE_2023 = 97 THEN NUM_D ELSE 0 END) AS '97',
    SUM(CASE WHEN AGE_2023 = 98 THEN NUM_D ELSE 0 END) AS '98',
    SUM(CASE WHEN AGE_2023 = 99 THEN NUM_D ELSE 0 END) AS '99',
    SUM(CASE WHEN AGE_2023 = 100 THEN NUM_D ELSE 0 END) AS '100',
    SUM(CASE WHEN AGE_2023 = 101 THEN NUM_D ELSE 0 END) AS '101',
    SUM(CASE WHEN AGE_2023 = 102 THEN NUM_D ELSE 0 END) AS '102',
    SUM(CASE WHEN AGE_2023 = 103 THEN NUM_D ELSE 0 END) AS '103',
    SUM(CASE WHEN AGE_2023 = 104 THEN NUM_D ELSE 0 END) AS '104',
    SUM(CASE WHEN AGE_2023 = 105 THEN NUM_D ELSE 0 END) AS '105',
    SUM(CASE WHEN AGE_2023 = 106 THEN NUM_D ELSE 0 END) AS '106',
    SUM(CASE WHEN AGE_2023 = 107 THEN NUM_D ELSE 0 END) AS '107',
    SUM(CASE WHEN AGE_2023 = 108 THEN NUM_D ELSE 0 END) AS '108',
    SUM(CASE WHEN AGE_2023 = 109 THEN NUM_D ELSE 0 END) AS '109',
    SUM(CASE WHEN AGE_2023 = 110 THEN NUM_D ELSE 0 END) AS '110',
    SUM(CASE WHEN AGE_2023 = 111 THEN NUM_D ELSE 0 END) AS '111',
    SUM(CASE WHEN AGE_2023 = 112 THEN NUM_D ELSE 0 END) AS '112',
    SUM(CASE WHEN AGE_2023 = 113 THEN NUM_D ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        AGE_2023,
        NUM_D
    FROM 
        DAYS_AGE_RANGE
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_DUVX
DROP VIEW IF EXISTS PVT_NUM_DUVX;
CREATE VIEW PVT_NUM_DUVX AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_DUVX ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_DUVX ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_DUVX ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_DUVX ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_DUVX ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_DUVX ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_DUVX ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_DUVX ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_DUVX ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_DUVX ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_DUVX ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_DUVX ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_DUVX ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_DUVX ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_DUVX ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_DUVX ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_DUVX ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_DUVX ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_DUVX ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_DUVX ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_DUVX ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_DUVX ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_DUVX ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_DUVX ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_DUVX ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_DUVX ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_DUVX ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_DUVX ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_DUVX ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_DUVX ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_DUVX ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_DUVX ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_DUVX ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_DUVX ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_DUVX ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_DUVX ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_DUVX ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_DUVX ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_DUVX ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_DUVX ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_DUVX ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_DUVX ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_DUVX ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_DUVX ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_DUVX ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_DUVX ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_DUVX ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_DUVX ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_DUVX ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_DUVX ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_DUVX ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_DUVX ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_DUVX ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_DUVX ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_DUVX ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_DUVX ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_DUVX ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_DUVX ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_DUVX ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_DUVX ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_DUVX ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_DUVX ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_DUVX ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_DUVX ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_DUVX ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_DUVX ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_DUVX ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_DUVX ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_DUVX ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_DUVX ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_DUVX ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_DUVX ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_DUVX ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_DUVX ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_DUVX ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_DUVX ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_DUVX ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_DUVX ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_DUVX ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_DUVX ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_DUVX ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_DUVX ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_DUVX ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_DUVX ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_DUVX ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_DUVX ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_DUVX ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_DUVX ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_DUVX ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_DUVX ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_DUVX ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_DUVX ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_DUVX ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_DUVX ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_DUVX ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_DUVX ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_DUVX ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_DUVX ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_DUVX ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_DUVX ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_DUVX ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_DUVX ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_DUVX ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_DUVX ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_DUVX ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_DUVX ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_DUVX ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_DUVX ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_DUVX ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_DUVX ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_DUVX ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_DUVX ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_DUVX ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_DUVX ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS VARCHAR) AS AgeRange, 
        NUM_DUVX
    FROM DAYS_AGE_RANGE
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_DVX
DROP VIEW IF EXISTS PVT_NUM_DVX;
CREATE VIEW PVT_NUM_DVX AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_DVX ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_DVX ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_DVX ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_DVX ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_DVX ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_DVX ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_DVX ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_DVX ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_DVX ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_DVX ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_DVX ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_DVX ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_DVX ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_DVX ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_DVX ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_DVX ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_DVX ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_DVX ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_DVX ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_DVX ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_DVX ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_DVX ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_DVX ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_DVX ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_DVX ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_DVX ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_DVX ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_DVX ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_DVX ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_DVX ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_DVX ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_DVX ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_DVX ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_DVX ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_DVX ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_DVX ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_DVX ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_DVX ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_DVX ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_DVX ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_DVX ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_DVX ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_DVX ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_DVX ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_DVX ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_DVX ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_DVX ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_DVX ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_DVX ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_DVX ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_DVX ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_DVX ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_DVX ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_DVX ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_DVX ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_DVX ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_DVX ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_DVX ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_DVX ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_DVX ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_DVX ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_DVX ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_DVX ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_DVX ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_DVX ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_DVX ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_DVX ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_DVX ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_DVX ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_DVX ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_DVX ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_DVX ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_DVX ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_DVX ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_DVX ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_DVX ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_DVX ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_DVX ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_DVX ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_DVX ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_DVX ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_DVX ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_DVX ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_DVX ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_DVX ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_DVX ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_DVX ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_DVX ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_DVX ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_DVX ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_DVX ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_DVX ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_DVX ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_DVX ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_DVX ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_DVX ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_DVX ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_DVX ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_DVX ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_DVX ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_DVX ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_DVX ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_DVX ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_DVX ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_DVX ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_DVX ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_DVX ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_DVX ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_DVX ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_DVX ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_DVX ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_DVX ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_DVX ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_DVX ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS VARCHAR) AS AgeRange,
        NUM_DVX
    FROM DAYS_AGE_RANGE
) AS AgeRanges
GROUP BY DAY;


-- create view PVT_NUM_DVD1
DROP VIEW IF EXISTS PVT_NUM_DVD1;
CREATE VIEW PVT_NUM_DVD1 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_DVD1 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_DVD1 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_DVD1 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_DVD1 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_DVD1 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_DVD1 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_DVD1 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_DVD1 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_DVD1 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_DVD1 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_DVD1 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_DVD1 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_DVD1 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_DVD1 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_DVD1 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_DVD1 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_DVD1 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_DVD1 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_DVD1 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_DVD1 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_DVD1 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_DVD1 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_DVD1 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_DVD1 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_DVD1 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_DVD1 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_DVD1 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_DVD1 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_DVD1 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_DVD1 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_DVD1 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_DVD1 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_DVD1 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_DVD1 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_DVD1 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_DVD1 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_DVD1 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_DVD1 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_DVD1 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_DVD1 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_DVD1 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_DVD1 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_DVD1 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_DVD1 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_DVD1 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_DVD1 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_DVD1 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_DVD1 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_DVD1 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_DVD1 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_DVD1 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_DVD1 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_DVD1 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_DVD1 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_DVD1 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_DVD1 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_DVD1 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_DVD1 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_DVD1 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_DVD1 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_DVD1 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_DVD1 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_DVD1 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_DVD1 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_DVD1 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_DVD1 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_DVD1 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_DVD1 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_DVD1 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_DVD1 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_DVD1 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_DVD1 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_DVD1 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_DVD1 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_DVD1 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_DVD1 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_DVD1 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_DVD1 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_DVD1 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_DVD1 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_DVD1 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_DVD1 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_DVD1 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_DVD1 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_DVD1 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_DVD1 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_DVD1 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_DVD1 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_DVD1 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_DVD1 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_DVD1 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_DVD1 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_DVD1 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_DVD1 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_DVD1 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_DVD1 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_DVD1 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_DVD1 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_DVD1 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_DVD1 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_DVD1 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_DVD1 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_DVD1 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_DVD1 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_DVD1 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_DVD1 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_DVD1 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_DVD1 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_DVD1 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_DVD1 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_DVD1 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_DVD1 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_DVD1 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_DVD1 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS VARCHAR) AS AgeRange,
        NUM_DVD1
    FROM DAYS_AGE_RANGE
) AS AgeRanges
GROUP BY DAY;


-- create view PVT_NUM_DVD2
DROP VIEW IF EXISTS PVT_NUM_DVD2;
CREATE VIEW PVT_NUM_DVD2 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_DVD2 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_DVD2 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_DVD2 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_DVD2 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_DVD2 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_DVD2 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_DVD2 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_DVD2 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_DVD2 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_DVD2 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_DVD2 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_DVD2 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_DVD2 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_DVD2 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_DVD2 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_DVD2 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_DVD2 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_DVD2 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_DVD2 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_DVD2 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_DVD2 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_DVD2 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_DVD2 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_DVD2 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_DVD2 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_DVD2 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_DVD2 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_DVD2 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_DVD2 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_DVD2 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_DVD2 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_DVD2 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_DVD2 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_DVD2 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_DVD2 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_DVD2 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_DVD2 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_DVD2 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_DVD2 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_DVD2 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_DVD2 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_DVD2 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_DVD2 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_DVD2 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_DVD2 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_DVD2 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_DVD2 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_DVD2 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_DVD2 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_DVD2 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_DVD2 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_DVD2 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_DVD2 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_DVD2 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_DVD2 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_DVD2 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_DVD2 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_DVD2 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_DVD2 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_DVD2 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_DVD2 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_DVD2 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_DVD2 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_DVD2 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_DVD2 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_DVD2 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_DVD2 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_DVD2 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_DVD2 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_DVD2 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_DVD2 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_DVD2 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_DVD2 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_DVD2 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_DVD2 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_DVD2 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_DVD2 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_DVD2 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_DVD2 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_DVD2 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_DVD2 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_DVD2 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_DVD2 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_DVD2 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_DVD2 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_DVD2 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_DVD2 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_DVD2 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_DVD2 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_DVD2 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_DVD2 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_DVD2 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_DVD2 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_DVD2 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_DVD2 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_DVD2 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_DVD2 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_DVD2 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_DVD2 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_DVD2 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_DVD2 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_DVD2 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_DVD2 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_DVD2 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_DVD2 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_DVD2 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_DVD2 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_DVD2 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_DVD2 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_DVD2 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_DVD2 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_DVD2 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_DVD2 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_DVD2 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS VARCHAR) AS AgeRange,
        NUM_DVD2
    FROM DAYS_AGE_RANGE
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_DVD3
DROP VIEW IF EXISTS PVT_NUM_DVD3;
CREATE VIEW PVT_NUM_DVD3 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_DVD3 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_DVD3 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_DVD3 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_DVD3 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_DVD3 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_DVD3 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_DVD3 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_DVD3 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_DVD3 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_DVD3 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_DVD3 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_DVD3 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_DVD3 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_DVD3 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_DVD3 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_DVD3 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_DVD3 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_DVD3 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_DVD3 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_DVD3 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_DVD3 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_DVD3 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_DVD3 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_DVD3 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_DVD3 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_DVD3 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_DVD3 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_DVD3 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_DVD3 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_DVD3 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_DVD3 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_DVD3 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_DVD3 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_DVD3 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_DVD3 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_DVD3 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_DVD3 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_DVD3 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_DVD3 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_DVD3 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_DVD3 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_DVD3 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_DVD3 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_DVD3 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_DVD3 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_DVD3 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_DVD3 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_DVD3 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_DVD3 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_DVD3 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_DVD3 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_DVD3 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_DVD3 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_DVD3 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_DVD3 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_DVD3 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_DVD3 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_DVD3 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_DVD3 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_DVD3 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_DVD3 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_DVD3 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_DVD3 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_DVD3 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_DVD3 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_DVD3 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_DVD3 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_DVD3 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_DVD3 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_DVD3 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_DVD3 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_DVD3 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_DVD3 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_DVD3 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_DVD3 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_DVD3 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_DVD3 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_DVD3 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_DVD3 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_DVD3 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_DVD3 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_DVD3 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_DVD3 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_DVD3 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_DVD3 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_DVD3 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_DVD3 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_DVD3 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_DVD3 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_DVD3 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_DVD3 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_DVD3 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_DVD3 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_DVD3 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_DVD3 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_DVD3 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_DVD3 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_DVD3 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_DVD3 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_DVD3 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_DVD3 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_DVD3 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_DVD3 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_DVD3 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_DVD3 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_DVD3 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_DVD3 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_DVD3 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_DVD3 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_DVD3 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_DVD3 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_DVD3 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_DVD3 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_DVD3 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS CHAR) AS AgeRange,  -- Treat age as a string for direct matching to columns
        NUM_DVD3
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_DVD3
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_DVD3
) AS AgeRanges
GROUP BY DAY;


-- create view PVT_NUM_DVD4
DROP VIEW IF EXISTS PVT_NUM_DVD4;
CREATE VIEW PVT_NUM_DVD4 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_DVD4 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_DVD4 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_DVD4 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_DVD4 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_DVD4 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_DVD4 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_DVD4 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_DVD4 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_DVD4 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_DVD4 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_DVD4 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_DVD4 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_DVD4 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_DVD4 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_DVD4 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_DVD4 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_DVD4 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_DVD4 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_DVD4 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_DVD4 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_DVD4 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_DVD4 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_DVD4 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_DVD4 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_DVD4 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_DVD4 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_DVD4 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_DVD4 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_DVD4 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_DVD4 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_DVD4 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_DVD4 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_DVD4 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_DVD4 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_DVD4 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_DVD4 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_DVD4 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_DVD4 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_DVD4 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_DVD4 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_DVD4 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_DVD4 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_DVD4 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_DVD4 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_DVD4 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_DVD4 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_DVD4 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_DVD4 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_DVD4 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_DVD4 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_DVD4 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_DVD4 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_DVD4 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_DVD4 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_DVD4 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_DVD4 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_DVD4 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_DVD4 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_DVD4 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_DVD4 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_DVD4 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_DVD4 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_DVD4 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_DVD4 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_DVD4 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_DVD4 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_DVD4 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_DVD4 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_DVD4 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_DVD4 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_DVD4 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_DVD4 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_DVD4 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_DVD4 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_DVD4 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_DVD4 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_DVD4 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_DVD4 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_DVD4 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_DVD4 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_DVD4 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_DVD4 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_DVD4 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_DVD4 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_DVD4 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_DVD4 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_DVD4 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_DVD4 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_DVD4 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_DVD4 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_DVD4 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_DVD4 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_DVD4 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_DVD4 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_DVD4 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_DVD4 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_DVD4 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_DVD4 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_DVD4 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_DVD4 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_DVD4 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_DVD4 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_DVD4 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_DVD4 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_DVD4 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_DVD4 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_DVD4 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_DVD4 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_DVD4 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_DVD4 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_DVD4 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_DVD4 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_DVD4 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_DVD4 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        AGE_2023 AS AgeRange,
        NUM_DVD4
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_DVD4
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_DVD4
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_DVD5
DROP VIEW IF EXISTS PVT_NUM_DVD5;
CREATE VIEW PVT_NUM_DVD5 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_DVD5 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_DVD5 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_DVD5 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_DVD5 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_DVD5 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_DVD5 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_DVD5 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_DVD5 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_DVD5 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_DVD5 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_DVD5 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_DVD5 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_DVD5 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_DVD5 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_DVD5 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_DVD5 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_DVD5 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_DVD5 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_DVD5 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_DVD5 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_DVD5 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_DVD5 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_DVD5 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_DVD5 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_DVD5 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_DVD5 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_DVD5 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_DVD5 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_DVD5 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_DVD5 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_DVD5 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_DVD5 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_DVD5 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_DVD5 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_DVD5 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_DVD5 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_DVD5 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_DVD5 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_DVD5 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_DVD5 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_DVD5 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_DVD5 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_DVD5 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_DVD5 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_DVD5 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_DVD5 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_DVD5 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_DVD5 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_DVD5 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_DVD5 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_DVD5 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_DVD5 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_DVD5 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_DVD5 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_DVD5 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_DVD5 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_DVD5 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_DVD5 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_DVD5 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_DVD5 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_DVD5 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_DVD5 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_DVD5 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_DVD5 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_DVD5 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_DVD5 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_DVD5 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_DVD5 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_DVD5 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_DVD5 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_DVD5 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_DVD5 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_DVD5 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_DVD5 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_DVD5 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_DVD5 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_DVD5 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_DVD5 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_DVD5 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_DVD5 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_DVD5 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_DVD5 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_DVD5 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_DVD5 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_DVD5 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_DVD5 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_DVD5 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_DVD5 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_DVD5 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_DVD5 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_DVD5 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_DVD5 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_DVD5 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_DVD5 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_DVD5 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_DVD5 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_DVD5 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_DVD5 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_DVD5 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_DVD5 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_DVD5 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_DVD5 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_DVD5 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_DVD5 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_DVD5 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_DVD5 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_DVD5 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_DVD5 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_DVD5 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_DVD5 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_DVD5 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_DVD5 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_DVD5 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_DVD5 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        AGE_2023 AS AgeRange,
        NUM_DVD5
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_DVD5
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_DVD5
) AS AgeRanges
GROUP BY DAY;


-- create view PVT_NUM_DVD6
DROP VIEW IF EXISTS PVT_NUM_DVD6;
CREATE VIEW PVT_NUM_DVD6 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_DVD6 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_DVD6 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_DVD6 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_DVD6 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_DVD6 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_DVD6 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_DVD6 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_DVD6 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_DVD6 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_DVD6 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_DVD6 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_DVD6 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_DVD6 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_DVD6 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_DVD6 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_DVD6 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_DVD6 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_DVD6 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_DVD6 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_DVD6 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_DVD6 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_DVD6 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_DVD6 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_DVD6 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_DVD6 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_DVD6 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_DVD6 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_DVD6 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_DVD6 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_DVD6 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_DVD6 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_DVD6 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_DVD6 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_DVD6 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_DVD6 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_DVD6 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_DVD6 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_DVD6 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_DVD6 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_DVD6 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_DVD6 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_DVD6 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_DVD6 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_DVD6 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_DVD6 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_DVD6 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_DVD6 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_DVD6 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_DVD6 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_DVD6 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_DVD6 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_DVD6 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_DVD6 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_DVD6 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_DVD6 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_DVD6 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_DVD6 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_DVD6 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_DVD6 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_DVD6 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_DVD6 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_DVD6 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_DVD6 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_DVD6 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_DVD6 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_DVD6 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_DVD6 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_DVD6 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_DVD6 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_DVD6 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_DVD6 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_DVD6 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_DVD6 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_DVD6 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_DVD6 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_DVD6 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_DVD6 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_DVD6 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_DVD6 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_DVD6 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_DVD6 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_DVD6 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_DVD6 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_DVD6 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_DVD6 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_DVD6 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_DVD6 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_DVD6 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_DVD6 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_DVD6 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_DVD6 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_DVD6 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_DVD6 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_DVD6 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_DVD6 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_DVD6 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_DVD6 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_DVD6 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_DVD6 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_DVD6 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_DVD6 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_DVD6 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_DVD6 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_DVD6 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_DVD6 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_DVD6 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_DVD6 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_DVD6 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_DVD6 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_DVD6 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_DVD6 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_DVD6 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_DVD6 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_DVD6 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        AGE_2023 AS AgeRange,
        NUM_DVD6
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_DVD6
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_DVD6
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_DVD7
DROP VIEW IF EXISTS PVT_NUM_DVD7;
CREATE VIEW PVT_NUM_DVD7 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_DVD7 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_DVD7 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_DVD7 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_DVD7 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_DVD7 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_DVD7 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_DVD7 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_DVD7 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_DVD7 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_DVD7 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_DVD7 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_DVD7 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_DVD7 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_DVD7 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_DVD7 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_DVD7 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_DVD7 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_DVD7 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_DVD7 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_DVD7 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_DVD7 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_DVD7 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_DVD7 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_DVD7 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_DVD7 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_DVD7 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_DVD7 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_DVD7 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_DVD7 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_DVD7 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_DVD7 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_DVD7 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_DVD7 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_DVD7 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_DVD7 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_DVD7 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_DVD7 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_DVD7 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_DVD7 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_DVD7 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_DVD7 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_DVD7 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_DVD7 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_DVD7 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_DVD7 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_DVD7 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_DVD7 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_DVD7 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_DVD7 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_DVD7 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_DVD7 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_DVD7 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_DVD7 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_DVD7 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_DVD7 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_DVD7 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_DVD7 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_DVD7 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_DVD7 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_DVD7 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_DVD7 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_DVD7 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_DVD7 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_DVD7 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_DVD7 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_DVD7 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_DVD7 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_DVD7 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_DVD7 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_DVD7 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_DVD7 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_DVD7 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_DVD7 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_DVD7 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_DVD7 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_DVD7 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_DVD7 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_DVD7 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_DVD7 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_DVD7 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_DVD7 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_DVD7 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_DVD7 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_DVD7 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_DVD7 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_DVD7 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_DVD7 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_DVD7 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_DVD7 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_DVD7 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_DVD7 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_DVD7 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_DVD7 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_DVD7 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_DVD7 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_DVD7 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_DVD7 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_DVD7 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_DVD7 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_DVD7 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_DVD7 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_DVD7 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_DVD7 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_DVD7 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_DVD7 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_DVD7 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_DVD7 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_DVD7 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_DVD7 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_DVD7 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_DVD7 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_DVD7 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_DVD7 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_DVD7 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        AGE_2023 AS AgeRange,
        NUM_DVD7
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_DVD7
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_DVD7
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_DVDA
DROP VIEW IF EXISTS PVT_NUM_DVDA;
CREATE VIEW PVT_NUM_DVDA AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_DVDA ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_DVDA ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_DVDA ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_DVDA ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_DVDA ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_DVDA ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_DVDA ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_DVDA ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_DVDA ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_DVDA ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_DVDA ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_DVDA ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_DVDA ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_DVDA ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_DVDA ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_DVDA ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_DVDA ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_DVDA ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_DVDA ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_DVDA ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_DVDA ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_DVDA ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_DVDA ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_DVDA ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_DVDA ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_DVDA ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_DVDA ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_DVDA ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_DVDA ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_DVDA ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_DVDA ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_DVDA ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_DVDA ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_DVDA ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_DVDA ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_DVDA ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_DVDA ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_DVDA ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_DVDA ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_DVDA ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_DVDA ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_DVDA ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_DVDA ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_DVDA ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_DVDA ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_DVDA ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_DVDA ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_DVDA ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_DVDA ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_DVDA ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_DVDA ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_DVDA ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_DVDA ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_DVDA ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_DVDA ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_DVDA ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_DVDA ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_DVDA ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_DVDA ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_DVDA ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_DVDA ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_DVDA ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_DVDA ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_DVDA ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_DVDA ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_DVDA ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_DVDA ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_DVDA ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_DVDA ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_DVDA ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_DVDA ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_DVDA ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_DVDA ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_DVDA ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_DVDA ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_DVDA ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_DVDA ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_DVDA ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_DVDA ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_DVDA ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_DVDA ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_DVDA ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_DVDA ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_DVDA ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_DVDA ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_DVDA ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_DVDA ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_DVDA ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_DVDA ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_DVDA ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_DVDA ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_DVDA ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_DVDA ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_DVDA ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_DVDA ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_DVDA ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_DVDA ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_DVDA ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_DVDA ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_DVDA ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_DVDA ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_DVDA ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_DVDA ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_DVDA ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_DVDA ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_DVDA ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_DVDA ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_DVDA ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_DVDA ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_DVDA ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_DVDA ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_DVDA ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_DVDA ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_DVDA ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        AGE_2023 AS AgeRange,
        NUM_DVDA
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_DVDA
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_DVDA
) AS AgeRanges
GROUP BY DAY;


-- create view PVT_NUM_POP
DROP VIEW IF EXISTS PVT_NUM_POP;
CREATE VIEW PVT_NUM_POP AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_POP ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_POP ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_POP ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_POP ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_POP ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_POP ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_POP ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_POP ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_POP ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_POP ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_POP ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_POP ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_POP ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_POP ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_POP ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_POP ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_POP ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_POP ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_POP ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_POP ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_POP ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_POP ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_POP ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_POP ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_POP ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_POP ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_POP ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_POP ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_POP ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_POP ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_POP ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_POP ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_POP ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_POP ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_POP ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_POP ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_POP ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_POP ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_POP ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_POP ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_POP ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_POP ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_POP ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_POP ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_POP ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_POP ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_POP ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_POP ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_POP ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_POP ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_POP ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_POP ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_POP ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_POP ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_POP ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_POP ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_POP ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_POP ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_POP ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_POP ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_POP ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_POP ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_POP ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_POP ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_POP ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_POP ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_POP ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_POP ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_POP ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_POP ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_POP ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_POP ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_POP ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_POP ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_POP ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_POP ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_POP ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_POP ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_POP ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_POP ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_POP ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_POP ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_POP ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_POP ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_POP ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_POP ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_POP ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_POP ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_POP ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_POP ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_POP ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_POP ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_POP ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_POP ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_POP ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_POP ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_POP ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_POP ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_POP ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_POP ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_POP ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_POP ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_POP ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_POP ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_POP ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_POP ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_POP ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_POP ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_POP ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_POP ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_POP ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_POP ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_POP ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_POP ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        AGE_2023 AS AgeRange,
        NUM_POP
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_POP
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_POP
) AS AgeRanges
GROUP BY DAY;


-- create view PVT_NUM_UVX
DROP VIEW IF EXISTS PVT_NUM_UVX;
CREATE VIEW PVT_NUM_UVX AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_UVX ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_UVX ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_UVX ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_UVX ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_UVX ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_UVX ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_UVX ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_UVX ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_UVX ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_UVX ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_UVX ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_UVX ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_UVX ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_UVX ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_UVX ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_UVX ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_UVX ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_UVX ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_UVX ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_UVX ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_UVX ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_UVX ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_UVX ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_UVX ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_UVX ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_UVX ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_UVX ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_UVX ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_UVX ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_UVX ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_UVX ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_UVX ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_UVX ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_UVX ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_UVX ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_UVX ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_UVX ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_UVX ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_UVX ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_UVX ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_UVX ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_UVX ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_UVX ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_UVX ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_UVX ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_UVX ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_UVX ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_UVX ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_UVX ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_UVX ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_UVX ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_UVX ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_UVX ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_UVX ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_UVX ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_UVX ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_UVX ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_UVX ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_UVX ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_UVX ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_UVX ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_UVX ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_UVX ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_UVX ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_UVX ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_UVX ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_UVX ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_UVX ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_UVX ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_UVX ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_UVX ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_UVX ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_UVX ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_UVX ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_UVX ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_UVX ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_UVX ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_UVX ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_UVX ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_UVX ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_UVX ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_UVX ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_UVX ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_UVX ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_UVX ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_UVX ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_UVX ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_UVX ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_UVX ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_UVX ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_UVX ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_UVX ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_UVX ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_UVX ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_UVX ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_UVX ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_UVX ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_UVX ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_UVX ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_UVX ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_UVX ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_UVX ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_UVX ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_UVX ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_UVX ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_UVX ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_UVX ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_UVX ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_UVX ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_UVX ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_UVX ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_UVX ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_UVX ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_UVX ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        AGE_2023 AS AgeRange,
        NUM_UVX
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_UVX
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_UVX
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_VX
DROP VIEW IF EXISTS PVT_NUM_VX;
CREATE VIEW PVT_NUM_VX AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_VX ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_VX ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_VX ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_VX ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_VX ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_VX ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_VX ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_VX ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_VX ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_VX ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_VX ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_VX ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_VX ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_VX ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_VX ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_VX ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_VX ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_VX ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_VX ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_VX ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_VX ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_VX ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_VX ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_VX ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_VX ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_VX ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_VX ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_VX ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_VX ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_VX ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_VX ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_VX ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_VX ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_VX ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_VX ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_VX ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_VX ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_VX ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_VX ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_VX ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_VX ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_VX ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_VX ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_VX ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_VX ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_VX ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_VX ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_VX ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_VX ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_VX ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_VX ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_VX ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_VX ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_VX ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_VX ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_VX ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_VX ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_VX ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_VX ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_VX ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_VX ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_VX ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_VX ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_VX ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_VX ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_VX ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_VX ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_VX ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_VX ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_VX ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_VX ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_VX ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_VX ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_VX ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_VX ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_VX ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_VX ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_VX ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_VX ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_VX ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_VX ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_VX ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_VX ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_VX ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_VX ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_VX ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_VX ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_VX ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_VX ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_VX ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_VX ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_VX ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_VX ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_VX ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_VX ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_VX ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_VX ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_VX ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_VX ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_VX ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_VX ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_VX ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_VX ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_VX ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_VX ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_VX ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_VX ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_VX ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_VX ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_VX ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_VX ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_VX ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_VX ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_VX ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        AGE_2023 AS AgeRange,
        NUM_VX
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_VX
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_VX
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_VD1
DROP VIEW IF EXISTS PVT_NUM_VD1;
CREATE VIEW PVT_NUM_VD1 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_VD1 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_VD1 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_VD1 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_VD1 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_VD1 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_VD1 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_VD1 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_VD1 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_VD1 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_VD1 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_VD1 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_VD1 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_VD1 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_VD1 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_VD1 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_VD1 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_VD1 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_VD1 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_VD1 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_VD1 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_VD1 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_VD1 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_VD1 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_VD1 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_VD1 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_VD1 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_VD1 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_VD1 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_VD1 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_VD1 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_VD1 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_VD1 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_VD1 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_VD1 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_VD1 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_VD1 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_VD1 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_VD1 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_VD1 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_VD1 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_VD1 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_VD1 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_VD1 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_VD1 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_VD1 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_VD1 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_VD1 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_VD1 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_VD1 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_VD1 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_VD1 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_VD1 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_VD1 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_VD1 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_VD1 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_VD1 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_VD1 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_VD1 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_VD1 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_VD1 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_VD1 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_VD1 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_VD1 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_VD1 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_VD1 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_VD1 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_VD1 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_VD1 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_VD1 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_VD1 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_VD1 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_VD1 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_VD1 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_VD1 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_VD1 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_VD1 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_VD1 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_VD1 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_VD1 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_VD1 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_VD1 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_VD1 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_VD1 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_VD1 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_VD1 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_VD1 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_VD1 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_VD1 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_VD1 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_VD1 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_VD1 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_VD1 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_VD1 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_VD1 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_VD1 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_VD1 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_VD1 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_VD1 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_VD1 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_VD1 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_VD1 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_VD1 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_VD1 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_VD1 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_VD1 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_VD1 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_VD1 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_VD1 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_VD1 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_VD1 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_VD1 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_VD1 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_VD1 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_VD1 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS INT) AS AgeRange,
        NUM_VD1
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_VD1
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_VD1
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_VD2
DROP VIEW IF EXISTS PVT_NUM_VD2;
CREATE VIEW PVT_NUM_VD2 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_VD2 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_VD2 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_VD2 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_VD2 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_VD2 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_VD2 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_VD2 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_VD2 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_VD2 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_VD2 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_VD2 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_VD2 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_VD2 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_VD2 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_VD2 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_VD2 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_VD2 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_VD2 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_VD2 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_VD2 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_VD2 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_VD2 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_VD2 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_VD2 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_VD2 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_VD2 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_VD2 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_VD2 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_VD2 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_VD2 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_VD2 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_VD2 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_VD2 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_VD2 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_VD2 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_VD2 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_VD2 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_VD2 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_VD2 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_VD2 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_VD2 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_VD2 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_VD2 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_VD2 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_VD2 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_VD2 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_VD2 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_VD2 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_VD2 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_VD2 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_VD2 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_VD2 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_VD2 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_VD2 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_VD2 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_VD2 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_VD2 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_VD2 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_VD2 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_VD2 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_VD2 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_VD2 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_VD2 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_VD2 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_VD2 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_VD2 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_VD2 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_VD2 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_VD2 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_VD2 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_VD2 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_VD2 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_VD2 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_VD2 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_VD2 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_VD2 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_VD2 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_VD2 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_VD2 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_VD2 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_VD2 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_VD2 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_VD2 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_VD2 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_VD2 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_VD2 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_VD2 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_VD2 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_VD2 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_VD2 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_VD2 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_VD2 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_VD2 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_VD2 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_VD2 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_VD2 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_VD2 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_VD2 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_VD2 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_VD2 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_VD2 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_VD2 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_VD2 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_VD2 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_VD2 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_VD2 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_VD2 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_VD2 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_VD2 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_VD2 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_VD2 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_VD2 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_VD2 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_VD2 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS INT) AS AgeRange,
        NUM_VD2
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_VD2
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_VD2
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_VD3
DROP VIEW IF EXISTS PVT_NUM_VD3;
CREATE VIEW PVT_NUM_VD3 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_VD3 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_VD3 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_VD3 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_VD3 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_VD3 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_VD3 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_VD3 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_VD3 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_VD3 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_VD3 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_VD3 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_VD3 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_VD3 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_VD3 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_VD3 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_VD3 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_VD3 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_VD3 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_VD3 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_VD3 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_VD3 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_VD3 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_VD3 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_VD3 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_VD3 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_VD3 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_VD3 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_VD3 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_VD3 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_VD3 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_VD3 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_VD3 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_VD3 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_VD3 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_VD3 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_VD3 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_VD3 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_VD3 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_VD3 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_VD3 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_VD3 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_VD3 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_VD3 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_VD3 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_VD3 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_VD3 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_VD3 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_VD3 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_VD3 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_VD3 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_VD3 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_VD3 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_VD3 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_VD3 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_VD3 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_VD3 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_VD3 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_VD3 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_VD3 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_VD3 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_VD3 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_VD3 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_VD3 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_VD3 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_VD3 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_VD3 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_VD3 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_VD3 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_VD3 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_VD3 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_VD3 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_VD3 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_VD3 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_VD3 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_VD3 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_VD3 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_VD3 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_VD3 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_VD3 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_VD3 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_VD3 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_VD3 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_VD3 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_VD3 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_VD3 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_VD3 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_VD3 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_VD3 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_VD3 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_VD3 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_VD3 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_VD3 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_VD3 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_VD3 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_VD3 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_VD3 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_VD3 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_VD3 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_VD3 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_VD3 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_VD3 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_VD3 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_VD3 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_VD3 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_VD3 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_VD3 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_VD3 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_VD3 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_VD3 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_VD3 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_VD3 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_VD3 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_VD3 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_VD3 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS INT) AS AgeRange,
        NUM_VD3
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_VD3
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_VD3
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_VD4
DROP VIEW IF EXISTS PVT_NUM_VD4;
CREATE VIEW PVT_NUM_VD4 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_VD4 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_VD4 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_VD4 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_VD4 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_VD4 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_VD4 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_VD4 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_VD4 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_VD4 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_VD4 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_VD4 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_VD4 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_VD4 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_VD4 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_VD4 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_VD4 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_VD4 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_VD4 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_VD4 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_VD4 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_VD4 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_VD4 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_VD4 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_VD4 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_VD4 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_VD4 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_VD4 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_VD4 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_VD4 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_VD4 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_VD4 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_VD4 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_VD4 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_VD4 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_VD4 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_VD4 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_VD4 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_VD4 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_VD4 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_VD4 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_VD4 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_VD4 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_VD4 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_VD4 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_VD4 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_VD4 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_VD4 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_VD4 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_VD4 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_VD4 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_VD4 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_VD4 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_VD4 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_VD4 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_VD4 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_VD4 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_VD4 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_VD4 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_VD4 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_VD4 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_VD4 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_VD4 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_VD4 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_VD4 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_VD4 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_VD4 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_VD4 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_VD4 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_VD4 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_VD4 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_VD4 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_VD4 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_VD4 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_VD4 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_VD4 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_VD4 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_VD4 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_VD4 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_VD4 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_VD4 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_VD4 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_VD4 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_VD4 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_VD4 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_VD4 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_VD4 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_VD4 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_VD4 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_VD4 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_VD4 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_VD4 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_VD4 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_VD4 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_VD4 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_VD4 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_VD4 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_VD4 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_VD4 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_VD4 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_VD4 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_VD4 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_VD4 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_VD4 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_VD4 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_VD4 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_VD4 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_VD4 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_VD4 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_VD4 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_VD4 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_VD4 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_VD4 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_VD4 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_VD4 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS INT) AS AgeRange,
        NUM_VD4
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_VD4
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_VD4
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_VD5
DROP VIEW IF EXISTS PVT_NUM_VD5;
CREATE VIEW PVT_NUM_VD5 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_VD5 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_VD5 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_VD5 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_VD5 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_VD5 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_VD5 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_VD5 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_VD5 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_VD5 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_VD5 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_VD5 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_VD5 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_VD5 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_VD5 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_VD5 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_VD5 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_VD5 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_VD5 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_VD5 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_VD5 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_VD5 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_VD5 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_VD5 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_VD5 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_VD5 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_VD5 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_VD5 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_VD5 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_VD5 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_VD5 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_VD5 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_VD5 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_VD5 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_VD5 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_VD5 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_VD5 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_VD5 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_VD5 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_VD5 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_VD5 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_VD5 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_VD5 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_VD5 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_VD5 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_VD5 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_VD5 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_VD5 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_VD5 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_VD5 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_VD5 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_VD5 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_VD5 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_VD5 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_VD5 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_VD5 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_VD5 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_VD5 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_VD5 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_VD5 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_VD5 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_VD5 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_VD5 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_VD5 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_VD5 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_VD5 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_VD5 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_VD5 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_VD5 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_VD5 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_VD5 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_VD5 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_VD5 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_VD5 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_VD5 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_VD5 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_VD5 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_VD5 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_VD5 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_VD5 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_VD5 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_VD5 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_VD5 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_VD5 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_VD5 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_VD5 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_VD5 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_VD5 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_VD5 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_VD5 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_VD5 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_VD5 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_VD5 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_VD5 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_VD5 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_VD5 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_VD5 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_VD5 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_VD5 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_VD5 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_VD5 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_VD5 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_VD5 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_VD5 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_VD5 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_VD5 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_VD5 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_VD5 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_VD5 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_VD5 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_VD5 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_VD5 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_VD5 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_VD5 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_VD5 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS INT) AS AgeRange,
        NUM_VD5
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_VD5
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_VD5
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_VD6
DROP VIEW IF EXISTS PVT_NUM_VD6;
CREATE VIEW PVT_NUM_VD6 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_VD6 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_VD6 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_VD6 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_VD6 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_VD6 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_VD6 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_VD6 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_VD6 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_VD6 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_VD6 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_VD6 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_VD6 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_VD6 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_VD6 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_VD6 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_VD6 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_VD6 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_VD6 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_VD6 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_VD6 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_VD6 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_VD6 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_VD6 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_VD6 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_VD6 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_VD6 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_VD6 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_VD6 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_VD6 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_VD6 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_VD6 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_VD6 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_VD6 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_VD6 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_VD6 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_VD6 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_VD6 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_VD6 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_VD6 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_VD6 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_VD6 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_VD6 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_VD6 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_VD6 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_VD6 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_VD6 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_VD6 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_VD6 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_VD6 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_VD6 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_VD6 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_VD6 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_VD6 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_VD6 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_VD6 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_VD6 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_VD6 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_VD6 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_VD6 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_VD6 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_VD6 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_VD6 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_VD6 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_VD6 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_VD6 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_VD6 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_VD6 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_VD6 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_VD6 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_VD6 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_VD6 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_VD6 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_VD6 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_VD6 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_VD6 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_VD6 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_VD6 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_VD6 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_VD6 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_VD6 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_VD6 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_VD6 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_VD6 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_VD6 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_VD6 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_VD6 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_VD6 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_VD6 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_VD6 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_VD6 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_VD6 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_VD6 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_VD6 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_VD6 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_VD6 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_VD6 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_VD6 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_VD6 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_VD6 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_VD6 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_VD6 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_VD6 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_VD6 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_VD6 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_VD6 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_VD6 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_VD6 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_VD6 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_VD6 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_VD6 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_VD6 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_VD6 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_VD6 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_VD6 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS INT) AS AgeRange,
        NUM_VD6
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_VD6
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_VD6
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_VD7
DROP VIEW IF EXISTS PVT_NUM_VD7;
CREATE VIEW PVT_NUM_VD7 AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_VD7 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_VD7 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_VD7 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_VD7 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_VD7 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_VD7 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_VD7 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_VD7 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_VD7 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_VD7 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_VD7 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_VD7 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_VD7 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_VD7 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_VD7 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_VD7 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_VD7 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_VD7 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_VD7 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_VD7 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_VD7 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_VD7 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_VD7 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_VD7 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_VD7 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_VD7 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_VD7 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_VD7 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_VD7 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_VD7 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_VD7 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_VD7 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_VD7 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_VD7 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_VD7 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_VD7 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_VD7 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_VD7 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_VD7 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_VD7 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_VD7 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_VD7 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_VD7 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_VD7 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_VD7 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_VD7 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_VD7 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_VD7 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_VD7 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_VD7 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_VD7 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_VD7 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_VD7 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_VD7 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_VD7 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_VD7 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_VD7 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_VD7 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_VD7 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_VD7 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_VD7 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_VD7 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_VD7 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_VD7 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_VD7 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_VD7 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_VD7 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_VD7 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_VD7 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_VD7 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_VD7 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_VD7 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_VD7 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_VD7 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_VD7 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_VD7 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_VD7 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_VD7 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_VD7 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_VD7 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_VD7 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_VD7 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_VD7 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_VD7 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_VD7 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_VD7 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_VD7 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_VD7 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_VD7 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_VD7 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_VD7 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_VD7 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_VD7 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_VD7 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_VD7 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_VD7 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_VD7 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_VD7 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_VD7 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_VD7 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_VD7 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_VD7 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_VD7 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_VD7 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_VD7 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_VD7 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_VD7 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_VD7 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_VD7 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_VD7 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_VD7 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_VD7 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_VD7 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_VD7 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS INT) AS AgeRange,
        NUM_VD7
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_VD7
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_VD7
) AS AgeRanges
GROUP BY DAY;

-- create view PVT_NUM_VDA
DROP VIEW IF EXISTS PVT_NUM_VDA;
CREATE VIEW PVT_NUM_VDA AS
SELECT 
    DAY,
    SUM(CASE WHEN AgeRange = '0' THEN NUM_VDA ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = '1' THEN NUM_VDA ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = '2' THEN NUM_VDA ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = '3' THEN NUM_VDA ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = '4' THEN NUM_VDA ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = '5' THEN NUM_VDA ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = '6' THEN NUM_VDA ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = '7' THEN NUM_VDA ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = '8' THEN NUM_VDA ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = '9' THEN NUM_VDA ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = '10' THEN NUM_VDA ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = '11' THEN NUM_VDA ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = '12' THEN NUM_VDA ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = '13' THEN NUM_VDA ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = '14' THEN NUM_VDA ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = '15' THEN NUM_VDA ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = '16' THEN NUM_VDA ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = '17' THEN NUM_VDA ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = '18' THEN NUM_VDA ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = '19' THEN NUM_VDA ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = '20' THEN NUM_VDA ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = '21' THEN NUM_VDA ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = '22' THEN NUM_VDA ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = '23' THEN NUM_VDA ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = '24' THEN NUM_VDA ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = '25' THEN NUM_VDA ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = '26' THEN NUM_VDA ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = '27' THEN NUM_VDA ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = '28' THEN NUM_VDA ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = '29' THEN NUM_VDA ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = '30' THEN NUM_VDA ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = '31' THEN NUM_VDA ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = '32' THEN NUM_VDA ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = '33' THEN NUM_VDA ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = '34' THEN NUM_VDA ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = '35' THEN NUM_VDA ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = '36' THEN NUM_VDA ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = '37' THEN NUM_VDA ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = '38' THEN NUM_VDA ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = '39' THEN NUM_VDA ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = '40' THEN NUM_VDA ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = '41' THEN NUM_VDA ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = '42' THEN NUM_VDA ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = '43' THEN NUM_VDA ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = '44' THEN NUM_VDA ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = '45' THEN NUM_VDA ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = '46' THEN NUM_VDA ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = '47' THEN NUM_VDA ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = '48' THEN NUM_VDA ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = '49' THEN NUM_VDA ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = '50' THEN NUM_VDA ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = '51' THEN NUM_VDA ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = '52' THEN NUM_VDA ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = '53' THEN NUM_VDA ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = '54' THEN NUM_VDA ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = '55' THEN NUM_VDA ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = '56' THEN NUM_VDA ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = '57' THEN NUM_VDA ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = '58' THEN NUM_VDA ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = '59' THEN NUM_VDA ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = '60' THEN NUM_VDA ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = '61' THEN NUM_VDA ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = '62' THEN NUM_VDA ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = '63' THEN NUM_VDA ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = '64' THEN NUM_VDA ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = '65' THEN NUM_VDA ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = '66' THEN NUM_VDA ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = '67' THEN NUM_VDA ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = '68' THEN NUM_VDA ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = '69' THEN NUM_VDA ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = '70' THEN NUM_VDA ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = '71' THEN NUM_VDA ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = '72' THEN NUM_VDA ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = '73' THEN NUM_VDA ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = '74' THEN NUM_VDA ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = '75' THEN NUM_VDA ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = '76' THEN NUM_VDA ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = '77' THEN NUM_VDA ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = '78' THEN NUM_VDA ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = '79' THEN NUM_VDA ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = '80' THEN NUM_VDA ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = '81' THEN NUM_VDA ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = '82' THEN NUM_VDA ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = '83' THEN NUM_VDA ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = '84' THEN NUM_VDA ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = '85' THEN NUM_VDA ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = '86' THEN NUM_VDA ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = '87' THEN NUM_VDA ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = '88' THEN NUM_VDA ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = '89' THEN NUM_VDA ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = '90' THEN NUM_VDA ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = '91' THEN NUM_VDA ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = '92' THEN NUM_VDA ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = '93' THEN NUM_VDA ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = '94' THEN NUM_VDA ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = '95' THEN NUM_VDA ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = '96' THEN NUM_VDA ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = '97' THEN NUM_VDA ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = '98' THEN NUM_VDA ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = '99' THEN NUM_VDA ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = '100' THEN NUM_VDA ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = '101' THEN NUM_VDA ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = '102' THEN NUM_VDA ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = '103' THEN NUM_VDA ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = '104' THEN NUM_VDA ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = '105' THEN NUM_VDA ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = '106' THEN NUM_VDA ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = '107' THEN NUM_VDA ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = '108' THEN NUM_VDA ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = '109' THEN NUM_VDA ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = '110' THEN NUM_VDA ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = '111' THEN NUM_VDA ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = '112' THEN NUM_VDA ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = '113' THEN NUM_VDA ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAY,
        CAST(AGE_2023 AS INT) AS AgeRange,
        NUM_VDA
    FROM (
        SELECT DISTINCT 
            DAY, 
            AGE_2023, 
            DAYS_AGE_RANGE.NUM_VDA
        FROM 
            DAYS_AGE_RANGE
    ) AS NUM_VDA
) AS AgeRanges
GROUP BY DAY;

-- Add the column if it doesn't exist
ALTER TABLE CzechDAYS ADD COLUMN DAYS2D INTEGER;

-- Update the column based on the last non-null VD column
UPDATE CzechDAYS
SET DAYS2D = CASE
    WHEN D IS NOT NULL THEN 
        D - COALESCE(VD7, VD6, VD5, VD4, VD3, VD2, VD1)
    ELSE NULL
END
WHERE D IS NOT NULL 
AND (VD1 IS NOT NULL OR VD2 IS NOT NULL OR VD3 IS NOT NULL OR 
     VD4 IS NOT NULL OR VD5 IS NOT NULL OR VD6 IS NOT NULL OR VD7 IS NOT NULL);

DROP VIEW IF EXISTS PVT_Days2D;
CREATE VIEW PVT_Days2D AS
SELECT 
    DAYS2D,
    -- Generate columns dynamically for each age from 0 to 113
    SUM(CASE WHEN AgeRange = 0 THEN 1 ELSE 0 END) AS '0',
    SUM(CASE WHEN AgeRange = 1 THEN 1 ELSE 0 END) AS '1',
    SUM(CASE WHEN AgeRange = 2 THEN 1 ELSE 0 END) AS '2',
    SUM(CASE WHEN AgeRange = 3 THEN 1 ELSE 0 END) AS '3',
    SUM(CASE WHEN AgeRange = 4 THEN 1 ELSE 0 END) AS '4',
    SUM(CASE WHEN AgeRange = 5 THEN 1 ELSE 0 END) AS '5',
    SUM(CASE WHEN AgeRange = 6 THEN 1 ELSE 0 END) AS '6',
    SUM(CASE WHEN AgeRange = 7 THEN 1 ELSE 0 END) AS '7',
    SUM(CASE WHEN AgeRange = 8 THEN 1 ELSE 0 END) AS '8',
    SUM(CASE WHEN AgeRange = 9 THEN 1 ELSE 0 END) AS '9',
    SUM(CASE WHEN AgeRange = 10 THEN 1 ELSE 0 END) AS '10',
    SUM(CASE WHEN AgeRange = 11 THEN 1 ELSE 0 END) AS '11',
    SUM(CASE WHEN AgeRange = 12 THEN 1 ELSE 0 END) AS '12',
    SUM(CASE WHEN AgeRange = 13 THEN 1 ELSE 0 END) AS '13',
    SUM(CASE WHEN AgeRange = 14 THEN 1 ELSE 0 END) AS '14',
    SUM(CASE WHEN AgeRange = 15 THEN 1 ELSE 0 END) AS '15',
    SUM(CASE WHEN AgeRange = 16 THEN 1 ELSE 0 END) AS '16',
    SUM(CASE WHEN AgeRange = 17 THEN 1 ELSE 0 END) AS '17',
    SUM(CASE WHEN AgeRange = 18 THEN 1 ELSE 0 END) AS '18',
    SUM(CASE WHEN AgeRange = 19 THEN 1 ELSE 0 END) AS '19',
    SUM(CASE WHEN AgeRange = 20 THEN 1 ELSE 0 END) AS '20',
    SUM(CASE WHEN AgeRange = 21 THEN 1 ELSE 0 END) AS '21',
    SUM(CASE WHEN AgeRange = 22 THEN 1 ELSE 0 END) AS '22',
    SUM(CASE WHEN AgeRange = 23 THEN 1 ELSE 0 END) AS '23',
    SUM(CASE WHEN AgeRange = 24 THEN 1 ELSE 0 END) AS '24',
    SUM(CASE WHEN AgeRange = 25 THEN 1 ELSE 0 END) AS '25',
    SUM(CASE WHEN AgeRange = 26 THEN 1 ELSE 0 END) AS '26',
    SUM(CASE WHEN AgeRange = 27 THEN 1 ELSE 0 END) AS '27',
    SUM(CASE WHEN AgeRange = 28 THEN 1 ELSE 0 END) AS '28',
    SUM(CASE WHEN AgeRange = 29 THEN 1 ELSE 0 END) AS '29',
    SUM(CASE WHEN AgeRange = 30 THEN 1 ELSE 0 END) AS '30',
    SUM(CASE WHEN AgeRange = 31 THEN 1 ELSE 0 END) AS '31',
    SUM(CASE WHEN AgeRange = 32 THEN 1 ELSE 0 END) AS '32',
    SUM(CASE WHEN AgeRange = 33 THEN 1 ELSE 0 END) AS '33',
    SUM(CASE WHEN AgeRange = 34 THEN 1 ELSE 0 END) AS '34',
    SUM(CASE WHEN AgeRange = 35 THEN 1 ELSE 0 END) AS '35',
    SUM(CASE WHEN AgeRange = 36 THEN 1 ELSE 0 END) AS '36',
    SUM(CASE WHEN AgeRange = 37 THEN 1 ELSE 0 END) AS '37',
    SUM(CASE WHEN AgeRange = 38 THEN 1 ELSE 0 END) AS '38',
    SUM(CASE WHEN AgeRange = 39 THEN 1 ELSE 0 END) AS '39',
    SUM(CASE WHEN AgeRange = 40 THEN 1 ELSE 0 END) AS '40',
    SUM(CASE WHEN AgeRange = 41 THEN 1 ELSE 0 END) AS '41',
    SUM(CASE WHEN AgeRange = 42 THEN 1 ELSE 0 END) AS '42',
    SUM(CASE WHEN AgeRange = 43 THEN 1 ELSE 0 END) AS '43',
    SUM(CASE WHEN AgeRange = 44 THEN 1 ELSE 0 END) AS '44',
    SUM(CASE WHEN AgeRange = 45 THEN 1 ELSE 0 END) AS '45',
    SUM(CASE WHEN AgeRange = 46 THEN 1 ELSE 0 END) AS '46',
    SUM(CASE WHEN AgeRange = 47 THEN 1 ELSE 0 END) AS '47',
    SUM(CASE WHEN AgeRange = 48 THEN 1 ELSE 0 END) AS '48',
    SUM(CASE WHEN AgeRange = 49 THEN 1 ELSE 0 END) AS '49',
    SUM(CASE WHEN AgeRange = 50 THEN 1 ELSE 0 END) AS '50',
    SUM(CASE WHEN AgeRange = 51 THEN 1 ELSE 0 END) AS '51',
    SUM(CASE WHEN AgeRange = 52 THEN 1 ELSE 0 END) AS '52',
    SUM(CASE WHEN AgeRange = 53 THEN 1 ELSE 0 END) AS '53',
    SUM(CASE WHEN AgeRange = 54 THEN 1 ELSE 0 END) AS '54',
    SUM(CASE WHEN AgeRange = 55 THEN 1 ELSE 0 END) AS '55',
    SUM(CASE WHEN AgeRange = 56 THEN 1 ELSE 0 END) AS '56',
    SUM(CASE WHEN AgeRange = 57 THEN 1 ELSE 0 END) AS '57',
    SUM(CASE WHEN AgeRange = 58 THEN 1 ELSE 0 END) AS '58',
    SUM(CASE WHEN AgeRange = 59 THEN 1 ELSE 0 END) AS '59',
    SUM(CASE WHEN AgeRange = 60 THEN 1 ELSE 0 END) AS '60',
    SUM(CASE WHEN AgeRange = 61 THEN 1 ELSE 0 END) AS '61',
    SUM(CASE WHEN AgeRange = 62 THEN 1 ELSE 0 END) AS '62',
    SUM(CASE WHEN AgeRange = 63 THEN 1 ELSE 0 END) AS '63',
    SUM(CASE WHEN AgeRange = 64 THEN 1 ELSE 0 END) AS '64',
    SUM(CASE WHEN AgeRange = 65 THEN 1 ELSE 0 END) AS '65',
    SUM(CASE WHEN AgeRange = 66 THEN 1 ELSE 0 END) AS '66',
    SUM(CASE WHEN AgeRange = 67 THEN 1 ELSE 0 END) AS '67',
    SUM(CASE WHEN AgeRange = 68 THEN 1 ELSE 0 END) AS '68',
    SUM(CASE WHEN AgeRange = 69 THEN 1 ELSE 0 END) AS '69',
    SUM(CASE WHEN AgeRange = 70 THEN 1 ELSE 0 END) AS '70',
    SUM(CASE WHEN AgeRange = 71 THEN 1 ELSE 0 END) AS '71',
    SUM(CASE WHEN AgeRange = 72 THEN 1 ELSE 0 END) AS '72',
    SUM(CASE WHEN AgeRange = 73 THEN 1 ELSE 0 END) AS '73',
    SUM(CASE WHEN AgeRange = 74 THEN 1 ELSE 0 END) AS '74',
    SUM(CASE WHEN AgeRange = 75 THEN 1 ELSE 0 END) AS '75',
    SUM(CASE WHEN AgeRange = 76 THEN 1 ELSE 0 END) AS '76',
    SUM(CASE WHEN AgeRange = 77 THEN 1 ELSE 0 END) AS '77',
    SUM(CASE WHEN AgeRange = 78 THEN 1 ELSE 0 END) AS '78',
    SUM(CASE WHEN AgeRange = 79 THEN 1 ELSE 0 END) AS '79',
    SUM(CASE WHEN AgeRange = 80 THEN 1 ELSE 0 END) AS '80',
    SUM(CASE WHEN AgeRange = 81 THEN 1 ELSE 0 END) AS '81',
    SUM(CASE WHEN AgeRange = 82 THEN 1 ELSE 0 END) AS '82',
    SUM(CASE WHEN AgeRange = 83 THEN 1 ELSE 0 END) AS '83',
    SUM(CASE WHEN AgeRange = 84 THEN 1 ELSE 0 END) AS '84',
    SUM(CASE WHEN AgeRange = 85 THEN 1 ELSE 0 END) AS '85',
    SUM(CASE WHEN AgeRange = 86 THEN 1 ELSE 0 END) AS '86',
    SUM(CASE WHEN AgeRange = 87 THEN 1 ELSE 0 END) AS '87',
    SUM(CASE WHEN AgeRange = 88 THEN 1 ELSE 0 END) AS '88',
    SUM(CASE WHEN AgeRange = 89 THEN 1 ELSE 0 END) AS '89',
    SUM(CASE WHEN AgeRange = 90 THEN 1 ELSE 0 END) AS '90',
    SUM(CASE WHEN AgeRange = 91 THEN 1 ELSE 0 END) AS '91',
    SUM(CASE WHEN AgeRange = 92 THEN 1 ELSE 0 END) AS '92',
    SUM(CASE WHEN AgeRange = 93 THEN 1 ELSE 0 END) AS '93',
    SUM(CASE WHEN AgeRange = 94 THEN 1 ELSE 0 END) AS '94',
    SUM(CASE WHEN AgeRange = 95 THEN 1 ELSE 0 END) AS '95',
    SUM(CASE WHEN AgeRange = 96 THEN 1 ELSE 0 END) AS '96',
    SUM(CASE WHEN AgeRange = 97 THEN 1 ELSE 0 END) AS '97',
    SUM(CASE WHEN AgeRange = 98 THEN 1 ELSE 0 END) AS '98',
    SUM(CASE WHEN AgeRange = 99 THEN 1 ELSE 0 END) AS '99',
    SUM(CASE WHEN AgeRange = 100 THEN 1 ELSE 0 END) AS '100',
    SUM(CASE WHEN AgeRange = 101 THEN 1 ELSE 0 END) AS '101',
    SUM(CASE WHEN AgeRange = 102 THEN 1 ELSE 0 END) AS '102',
    SUM(CASE WHEN AgeRange = 103 THEN 1 ELSE 0 END) AS '103',
    SUM(CASE WHEN AgeRange = 104 THEN 1 ELSE 0 END) AS '104',
    SUM(CASE WHEN AgeRange = 105 THEN 1 ELSE 0 END) AS '105',
    SUM(CASE WHEN AgeRange = 106 THEN 1 ELSE 0 END) AS '106',
    SUM(CASE WHEN AgeRange = 107 THEN 1 ELSE 0 END) AS '107',
    SUM(CASE WHEN AgeRange = 108 THEN 1 ELSE 0 END) AS '108',
    SUM(CASE WHEN AgeRange = 109 THEN 1 ELSE 0 END) AS '109',
    SUM(CASE WHEN AgeRange = 110 THEN 1 ELSE 0 END) AS '110',
    SUM(CASE WHEN AgeRange = 111 THEN 1 ELSE 0 END) AS '111',
    SUM(CASE WHEN AgeRange = 112 THEN 1 ELSE 0 END) AS '112',
    SUM(CASE WHEN AgeRange = 113 THEN 1 ELSE 0 END) AS '113'
FROM (
    SELECT 
        DAYS2D,
        CAST(AGE_2023 AS INT) AS AgeRange
    FROM CzechDAYS
    WHERE DAYS2D IS NOT NULL
) AS AgeData
GROUP BY DAYS2D;

-- dowhy biniary survival estimate
DROP VIEW IF EXISTS PVT_DOSES_D;
CREATE VIEW PVT_DOSES_D AS
SELECT 
    RID,  -- Unique identifier for each person
    AGE_2023 AS Age, 
    -- Count the number of non-null dose dates (total doses received)
    (CASE WHEN VD1 IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN VD2 IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN VD3 IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN VD4 IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN VD5 IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN VD6 IS NOT NULL THEN 1 ELSE 0 END +
     CASE WHEN VD7 IS NOT NULL THEN 1 ELSE 0 END) AS Doses,
    -- Death date (NULL if alive)
    D AS Death_Date,
    -- Last dose day: take the latest (non-null) dose date
    CASE 
        WHEN VD7 IS NOT NULL THEN VD7
        WHEN VD6 IS NOT NULL THEN VD6
        WHEN VD5 IS NOT NULL THEN VD5
        WHEN VD4 IS NOT NULL THEN VD4
        WHEN VD3 IS NOT NULL THEN VD3
        WHEN VD2 IS NOT NULL THEN VD2
        WHEN VD1 IS NOT NULL THEN VD1
        ELSE NULL
    END AS Last_Dose_Day,
    -- Compute survival time as days from last dose to death (NULL if alive)
    CASE 
        WHEN D IS NOT NULL AND 
             (VD1 IS NOT NULL OR VD2 IS NOT NULL OR VD3 IS NOT NULL OR VD4 IS NOT NULL OR 
              VD5 IS NOT NULL OR VD6 IS NOT NULL OR VD7 IS NOT NULL) 
        THEN D - 
            (CASE 
                WHEN VD7 IS NOT NULL THEN VD7
                WHEN VD6 IS NOT NULL THEN VD6
                WHEN VD5 IS NOT NULL THEN VD5
                WHEN VD4 IS NOT NULL THEN VD4
                WHEN VD3 IS NOT NULL THEN VD3
                WHEN VD2 IS NOT NULL THEN VD2
                WHEN VD1 IS NOT NULL THEN VD1
                ELSE NULL
            END)
        ELSE NULL
    END AS Survival_Time,
    -- Mortality indicator (1 = died, 0 = alive)
    CASE 
        WHEN D IS NOT NULL THEN 1 
        ELSE 0 
    END AS Mortality
FROM 
    CzechDAYS;
